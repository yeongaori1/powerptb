/**
 * Copyright (c) 2018-2020 aetheryx & Bowser65
 * All Rights Reserved. Licensed under the Porkord License
 * https://powercord.dev/porkord-license
 */

/* eslint-disable object-property-newline, new-cap */

const { getModuleByDisplayName } = require('powercord/webpack');
const { findInReactTree, wrapInHooks } = require('powercord/util');
const AsyncComponent = require('./AsyncComponent');

module.exports = AsyncComponent.from(
  (async () => {
    const GuildSettingsRolesEditDisplay = await getModuleByDisplayName('GuildSettingsRolesEditDisplay');
    const SettingsPageContent = wrapInHooks(() => new GuildSettingsRolesEditDisplay({ guild: { id: '' }, role: { id: '' } }))();
    const ColorPickerFormItem = findInReactTree(SettingsPageContent, (n) => n.type?.displayName === 'ColorPickerFormItem').type({ role: { id: '' } });
    const SuspendedPicker = findInReactTree(ColorPickerFormItem, (n) => n.props?.defaultColor).type;
    const LazyWebpackModule = await SuspendedPicker().props.children.type;
    const mdl = await (LazyWebpackModule._ctor || LazyWebpackModule._payload._result)();

    return mdl.default;
  })()
);
